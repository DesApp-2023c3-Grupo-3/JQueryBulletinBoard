import{connection,initilizeConnection,sendMessage}from"./modules/webSocketConnection.js";import{getUrlParameter}from"./modules/utils.js";const SCREEN_ID=getUrlParameter("id");let billboardData=null,lastMessage=null;function loadTemplate(e){let n="default";n="default",$("#main").load("./templates/default.html",(()=>appendMessage(e)))}function onConnectionInitialized(e){$("#loader").text("Connected to the WebSocket server."),sendMessage("START_CONNECTION",SCREEN_ID)}function appendMessage(e){$("#sector_name").text(`${billboardData?.sector?.name||"No name"}`),$("#advertisings").append(`\n        <div>\n            <h6>${JSON.stringify(e.action)}</h6>\n            <p>${JSON.stringify(e?.data?.payload||e?.data?.sector?.name)}</p>\n        </div>\n    `)}function onMessage(e){const{data:n}=JSON.parse(e.data);if(null===billboardData)return billboardData=n.data,void loadTemplate(n);appendMessage(n)}const main=()=>{$("#loader").text("Cargando");try{connection.onOpen=onConnectionInitialized,connection.onMessage=onMessage,initilizeConnection()}catch(e){console.error(JSON.stringify(e)),$("#loader").text(`Error: ${JSON.stringify(e)}`)}};$(document).ready(main);